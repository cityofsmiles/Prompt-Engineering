<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Dynamic Lessig Math Presentation</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@4.5.0/dist/reveal.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@4.5.0/dist/theme/black.css">
    <script src="https://cdn.jsdelivr.net/npm/reveal.js@4.5.0/plugin/math/math.js"></script>
    <style>
        .reveal h2 { font-weight: 800; font-size: 3em; }
        img { max-height: 500px; border-radius: 10px; }
    </style>
</head>
<body>
    <div class="reveal">
        <div class="slides" id="dynamic-slides">
            <section>Loading Presentation...</section>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/reveal.js@4.5.0/dist/reveal.js"></script>
    <script>
        // PASTE YOUR PUBLISHED CSV URL HERE
        const sheetUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRNkl2LsAPhuRetdCsejtmCGftxe1AuzVxjpxbICCdLk5VLuuOMXV_Uz44L0c5Fh5eiZixdi8cMU1fC/pub?output=csv';

        async function loadSlides() {
            const response = await fetch(sheetUrl);
            const data = await response.text();
            const rows = data.split('\n').slice(1); // Skip header row
            const container = document.getElementById('dynamic-slides');
            container.innerHTML = ''; // Clear loading message

            rows.forEach(row => {
                const cols = row.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/); // Split CSV safely
                if (cols.length < 2) return;

                const [type, content, imgUrl] = cols.map(c => c.replace(/"/g, '').trim());
                const section = document.createElement('section');

                if (type === "Math") {
                    section.innerHTML = `<h2>\\[ ${content} \\]</h2>`;
                } else if (type === "Image") {
                    section.innerHTML = `<h2>${content}</h2><img src="${imgUrl}">`;
                } else {
                    section.innerHTML = `<h2>${content}</h2>`;
                }
                container.appendChild(section);
            });

            // Initialize Reveal after slides are loaded
            Reveal.initialize({
                hash: true,
                transition: 'none',
                plugins: [ RevealMath.MathJax2 ]
            });
        }

        loadSlides();
    </script>
</body>
</html>
